<?php
/*
JSON_SQL_Bridge 1.1
Copyright 2016 Frank Vanden berghen
All Right reserved.

JSON_SQL_Bridge is not a free software. The JSON_SQL_Bridge software is NOT licensed under the "Apache License". 
If you are interested in distributing, reselling, modifying, contibuting or in general creating 
any derivative work from JSON_SQL_Bridge, please contact Frank Vanden Berghen at frank@timi.eu.
*/
namespace kibella; require_once "functionsaux.php"; function O2u($l22,$l2v) { if (!is_array($l22) || count($l22) == 0) { user_error( "The input parameter is not an array or is empty ($l22)\n" ,E_USER_ERROR); return NULL; } else if ($l2v<0 || $l2v>=count($l22)) { error( "The index to extract from the array is out of range ($l2v while size of array is count($l22))\n" ,E_USER_ERROR); return NULL; } return $l22[$l2v]; } function O2v($l2w) { $O2w=strtotime($l2w)-strtotime("00:00"); $l2x=time()-strtotime("00:00"); if ($O2w<=$l2x) { $O2x=strtotime($l2w); } else { $O2x=strtotime($l2w)-0250600; } return $O2x; } function l2y($O2y) { $date=date_create(strftime("%Y-%m-%d %H:%M:%S",$O2y)); $l2z=(array) $date; $O2z=timezone_offset_get(new \datetimezone($date->timezone),$date); return $O2y-$O2z; } function l30($O30,$timezone="UTC") { $l31=array("s" => "second","m" => "minute","h" => "hour","d" => "day","w" => "week","M" => "month","y" => "year"); $O31="/^((now)|([\\d\\/-:\\s]+)\\|\\|)([-+])(\\d+)([smhdwMy]{1})\\w*\\/*([smhdwMy])*/"; preg_match($O31,$O30,$l32); if (count($l32)>0) { assert(count($l32)>=7,"The preg_match() array has at least 7 elements"); $date=date_create($l32[2].$l32[3]); if ($timezone !== NULL && $l32[2] !== "now") { $date=date_create(strftime("%Y-%m-%d %H:%M:%S",date_timestamp_get($date)),new \datetimezone($timezone)); } $O32=$l32[4].$l32[5]; $l33=$l32[6]; date_modify($date,"$O32 ".$l31[$l33]); $l2z=(array) $date; if (count($l32)>=8) { $O33=$l32[7]; l34($date,$O33); } } else { if ($timezone !== NULL) { $date=date_create($O30); $date=date_create(strftime("%Y-%m-%d %H:%M:%S",date_timestamp_get($date)),new \datetimezone($timezone)); } else { $date=date_create($O30); } } return date_timestamp_get($date); } function l34(&$O34,$O33) { switch ($O33) { case ("s"): date_modify($O34,strftime("%Y-%m-%d %H:%M:%S",strtotime($O34->date))); break; case ("m"): date_modify($O34,strftime("%Y-%m-%d %H:%M",strtotime($O34->date)).":00"); break; case ("h"): date_modify($O34,strftime("%Y-%m-%d %H",strtotime($O34->date)).":00:00"); break; case ("d"): date_modify($O34,strftime("%Y-%m-%d",strtotime($O34->date))." 00:00:00"); break; case ("w"): date_modify($O34,"last monday"); $l2z=(array) $O34; date_modify($O34,strftime("%Y-%m-%d",strtotime($O34->date))." 00:00:00"); break; case ("M"): date_modify($O34,"first day of this month"); $l2z=(array) $O34; date_modify($O34,strftime("%Y-%m-%d",strtotime($O34->date))." 00:00:00"); break; case ("y"): date_modify($O34,strftime("%Y",strtotime($O34->date))."-01-01 00:00:00"); break; default : break; } $l2z=(array) $O34; } function l35($O35) { $l36=preg_grep("/^\\-/",array($O35)); $O36=count($l36)>0; if ($O36) $O35=substr($O35,1); $l37=explode("-",$O35,2); $O37=$l37[0]; if ($O36) $O37="-".$O37; $l38=""; if (count($l37)>1) { $l38=$l37[1]; } return array($O37,$l38); } function O38($l39) { $O39=FALSE; $l3a=filemtime($l39); if (strtolower(CACHEMODE) === l2) { $l2w=CACHEDAYCHANGE; $O2x=O2v($l2w); if ($l3a<$O2x) { $O39=TRUE; } } else if (time()-$l3a>CACHEHOURS*07020) { $O39=TRUE; } return $O39; } function O3a($O20) { $O39=FALSE; $O20=trim($O20); if (strlen($O20)>0) { $O20=preg_replace("/^(\\-|\\+)\\s*/","\$1",$O20); if (!preg_match("/[^0123456789\\.\\-\\+]/",$O20)) { if (preg_match("/^.+(\\-|\\+)+/",$O20)) $O39=FALSE; else if (preg_match("/^(\\-\\.)|(\\+\\.)/",$O20) && preg_match("/\\.|\\-|\\+/",substr($O20,2))) $O39=FALSE; else if (preg_match_all("/\\./",$O20)>1) $O39=FALSE; else $O39=TRUE; } } return $O39; } function l3b($O3b,$l3c) { switch (( string) $O3b) { case (O13): $O3b=l14; break; case (l17): if ($l3c == l16) $O3b=l1e; break; case (l1h): if ($l3c == O14) $O3b=l15; else $O3b=O1a; break; default : break; } return $O3b; } function O3c($l3d,$O3d) { if ($l3d == $O3d) $l3e=""; else $l3e=","; return $l3e; } function O3e($l26) { if ($l26<=0) $l3f=""; else $l3f="LIMIT ".$l26; return $l3f; }